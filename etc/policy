grant CodeBase "file:jdcp-server.jar" {
    permission java.security.AllPermission;
};

grant CodeBase "file:jdcp-common.jar" {
    permission java.security.AllPermission;
};

grant CodeBase "file:jdcp-worker.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:jdcp-client.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:jdcp-console.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:lib/eandb.jar" {
    permission java.security.AllPermission;
};

grant CodeBase "file:lib/derby.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:lib/derbyclient.jar" {
	permission java.security.AllPermission;
};

grant CodeBase "file:lib/log4j-1.2.15.jar" {
	permission java.security.AllPermission;
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.worker" {
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDefinition";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
	permission ca.eandb.jdcp.security.JdcpPermission "getTaskWorker";
	permission ca.eandb.jdcp.security.JdcpPermission "requestTask";
	permission ca.eandb.jdcp.security.JdcpPermission "submitTaskResults";
	permission ca.eandb.jdcp.security.JdcpPermission "reportException";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.admin" {
    permission ca.eandb.jdcp.security.JdcpPermission "*";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.submitter.basic" {
	permission ca.eandb.jdcp.security.JdcpPermission "createJob";
	permission ca.eandb.jdcp.security.JdcpPermission "submitJob";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
};

grant Principal ca.eandb.util.auth.RolePrincipal "jdcp.submitter.advanced" {
	permission ca.eandb.jdcp.security.JdcpPermission "createJob";
	permission ca.eandb.jdcp.security.JdcpPermission "submitJob";
	permission ca.eandb.jdcp.security.JdcpPermission "setJobClassDefinition";
	permission ca.eandb.jdcp.security.JdcpPermission "getJobClassDigest";
};
